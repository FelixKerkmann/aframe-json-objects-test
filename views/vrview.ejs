<!DOCTYPE html>
<html>
<head>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="../public/js/backsideFixing.js"></script>
    <script src="../public/components/input-listen.js"></script>
    <link rel="icon" type="image/png" href="../public/resources/icons/favicon.png">
</head>
<body>

<!-- Scene view -->
    <a-scene shadow="type: pcfsoft" cursor="rayOrigin: mouse">
        <a-assets>
            <img id="citySkybox" src="../public/resources/skyboxes/citySkybox.jpg">
            <a-asset-item id="roomModel" src="../public/resources/uploads/rooms/DemoRaumDiffuseOnlyCompressed.glb"></a-asset-item>
            <%- assets %>
        </a-assets>

        <a-sky id="skybox" src="#citySkybox"></a-sky>

        <a-entity id="cameraRig">
            <a-entity id="player"
                      camera
                      wasd-controls
                      look-controls
                      position="0 1.6 0"
                      networked="template:#avatar-template;attachTemplateToLocal:false;" random-color>
                <a-sphere class="head"
                          visible="false"
                          random-color
                ></a-sphere>
            </a-entity>
            <a-entity id="ctlL"
                      teleport-controls="cameraRig: #cameraRig; teleportOrigin: #player; startEvents: teleportstart; endEvents: teleportend"
                      oculus-touch-controls="hand: left"
                      input-listen>
                <a-text value="X: Teleport"
                        position="0 0.08 0"
                        rotation="-90 0 0"
                        scale="0.1 0.1 0.1"
                        align="center"
                        color="#FFFFFF"></a-text>
                <a-sphere radius="0.01"
                          position="0 0 -1.2"
                          color="#FFFFFF"></a-sphere>
            </a-entity>
            <a-entity id="ctlR"
                      teleport-controls="cameraRig: #cameraRig; teleportOrigin: #player; startEvents: teleportstart; endEvents: teleportend"
                      oculus-touch-controls="hand: right"
                      input-listen>
                <a-text value="A: Teleport"
                        position="0 0.08 0"
                        rotation="-90 0 0"
                        scale="0.1 0.1 0.1"
                        align="center"
                        color="#FFFFFF"></a-text>
                <a-sphere radius="0.01"
                          position="0 0 -1.2"
                          color="#FFFFFF"></a-sphere>
            </a-entity>
        </a-entity>

        <a-entity id="ambientLight"
                  light="type: ambient; color: #FFFFFF; intensity: 0.6;">
        </a-entity>

        <a-entity id="pointLight"
                  light="type: point; color: #FFFFFF; intensity: 0.6; castShadow:true; shadowMapHeight: 1024; shadowMapWidth:1024;"
                  position="0 2.5 0"
        ></a-entity>

        <a-entity id="Room"
                  gltf-model=#roomModel
                  position="0 0 0"
                  rotation="0 0 0"
                  scale="1 1 1"
                  shadow="receive:true">
        </a-entity>

        <%- entities %>

    </a-scene>
<script>
    window.onload = () => {
        setAllBackfaces();
    }
</script>
</body>
</html>